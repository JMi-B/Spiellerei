[[2025-11-04]] <-> [[2025-11-06]]

| Zeit  | Termin     |
| ----- | ---------- |
| 7:50  | Kommen     |
| 9:30  | R&D Sync   |
| 14:30 | AzubiDaily |
| 15:00 | SQL        |

# SQL
#sql #join
# Erweiterung der Datenbank
#python #workflow #elt #dbmodel #pdf2Text 

## [[2025-11-04#Anleitungen die als pdf vorliegen in der DB]]
### Die Tabelle textdatei füllen
#workflow 
- Probe Datensätzte in die Datenbank geschrieben.
- Vorarbeiten [[2025-11-04#Neuer Ablauf]]
	- Daten in der exl angepasst
	- Dateien umbenannt
- Vor dem programmieren in lila enreach Klade alle Befehle als Text formuliert. (S. 112)
- Kaum Fehler
	- eine Klammer nicht richtig geschlossen
	- eine Variable ungenau benannt diesmedium_id statt dateimedium_id
	- ein unvollständiger DS in den Row Daten
		- gestern Date nicht richtig gespeichert nicht alle Änderungen in der exl
### Pdf umwandeln und Texte importieren
Verbindung mit der Datenbank nicht von Anfang an öffnen
- Daten auslesen und in Json schreiben
-  aus Json insert in DB
Einlesen der Texte ( von [[2025-11-04#Neuer Ablauf]] kopiert)
	- Prüfen ob DS existiert - Anleitung => AnleitungID
	- AND Dateiname existiert
	- Texte zum einlesen in ein Arbeitsverzeichnis kopieren
		- Dort wird zwischen gespeichert
		-  in neuem Pfad ablegen
			- in einzelne jpgs teilen
		- Bilder in einen Text umwandeln
		- **erst sammeln 
		- dann insert
			- jpgs, pfad und ursprüngliches Pdf löschen**
#### Vorhandenes script
 #ocr #Variablen #python #funktion 
 script - Inhalt 
- C:\Users\juliane.bonenkamp\HandArbeitenAnleitungenDB\scripts\JMiDB_funktion_pdf_bild_text_db_del.py
- aus dem #ocr Zusammenhang
- Variable `path` gibt den Pfad zu den einzulesenden Dateien an
- Variable `files` Liste der Dateien in `path`
- ##### Hauptprogramm
- Für alle Dateien `file` in der Liste `files`
- Wenn die Datei `file`ein pdf ist
	- Funktion `inBildUmwandel
		- gibt die Variablen `neuerpfad, images` zurück
		- verwendet die Variable `file` als `filename`
		- Erstellt einen neuen Pfad aus dem Dateinamen `neuerpfad`
		- Speichert in dem Pfad die einzelnen Seiten aus der Datei als jpg `images`
	- Funktion `jpgSeiten`
		- gibt die Variable `nummer` zurück
		- verwendet die Variable `neuerpfad, file`
			- zählt alle `image` in `imanges` und speichert sie in dem Verzeichnis `neuerpfad`
	- Funktion `ganzerText`
		- gibt die Variable `text_ganz` zurück
		- verwendet die Variable `neuerpfad`
			- verwendet `images` als `bilder`  -> nicht übergeben?
				- ruft für jedes `bild ` die Funktion `textAusBild`auf
					- Funktion `textAusBild`
						- verwendet `neuerpfad` als `pathtoimage`
						- wandelt Bild `img` in Text `text` um
						- gibt `text` zurück
				- speichert die Texte der einzelnen Seiten in einen einzigen Text, in dem die `text` hintereinander geschrieben werden
	- Funktion `eintragDB`
		- erstellt eine Timestamp 
		- legt den Text mit Pfad, Dateinamen und Timestamp in der DB ab
			- *mit einer anderen Konstruktion als in der  datei_import. py.*
	- Funktion `aufraemen`
		- Verwendet `neuerpfad, file`
		- löscht den angelegten pfad, die bilder und das ursprüngliche pdf
		- => der Ordner mit den pdf vom Anfang ist leer
- ##### Aufteilung
- Das einlesen der pdf und umwandeln in Texte
	- die einzelnen Seiten des Pdf werden gezählt und als jpg gespeichert
	- aus den jpg werden Texte aus gelesen und in die Variabler `text_ganz` geschrieben
	- Der Inhalt der Variable muss zwischengespeichert werden, damit mehre unterschiedliche Pdfs eingelesen werden können.
		- [ ] das ist wie api in js schreiben.
- in die DB schreiben und aufräumen
	- DB Verbindung aufbauen
	- Die DS sind schon angelegt
		- statt `INSERT` `UPDATE`
		- Richtigen DS finden in der Tabelle textdatei über dateiname
##### Wo und wie verwende ich den Dateinamen
Von der CSV in die DB
- MedienTitel - Dateiname ohne Endung
- Pfad - **Nicht** der Pfad um Text auszulesen
- Dateiname 
Für die Texterstellung




