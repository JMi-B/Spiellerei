[[2025-10-21]]
#Home #sql #subselects
# Beispiele von Georg
## Subselcts
Ich habe nochmal eben Beispieltabellen erstellt, mit denen ihr die Subselects nochmal ausprobieren könnt. Mit diesen Statements könnt ihr die Tabllen erstellen:

`CREATE TABLE Abteilung (  
  ` AbteilungID INT,  
    `AbteilungName VARCHAR(50),  
    `Ort VARCHAR(50)  
`);

`INSERT INTO Abteilung VALUES  
`(1, 'Marketing', 'Bochum'),  
`(2, 'Sales', 'Almere'),  
`(3, 'Support', 'Kopenhagen'),  
`(4, 'HR', 'Bochum');

`CREATE TABLE Mitarbeiter (  
  ` MitarbeiterID INT,  
  ` Name VARCHAR(50),  
    `AbteilungID INT,  
    `Gehalt INT  
    `);

`INSERT INTO Mitarbeiter VALUES  
`(101, 'Heinz', 1, 70000),  
`(102, 'Christopher', 2, 48000),  
`(103, 'Julia', 1, 58000),  
`(104, 'Emily', 3, 90000),  
`(105, 'Markus', 2, 52000),  
`(106, 'Sarah', 4, 72000);

Und hier sind zwei Queries, um das zu verdeutlichen. Angestellte in Abteilungen in Bochum:
*Suche mir aus der Tabelle Mittarbeiter über die AbteilungID alle Daten für die Mittarbeiter, die in der Tabelle Abteilung als Ort Bochum stehen haben*

`SELECT *  
`FROM Mitarbeiter  
`WHERE AbteilungID IN (  
 `` SELECT AbteilungID  
  `FROM Abteilung  
  `WHERE Ort = 'Bochum');

Angestellte, deren Gehalt höher als der Schnitt in ihrer Abteilung ist:
*Suche mir aus der Tabelle Mittarbeiter Name und Gehalt, bei denen das Gehalt größer ist als das Durchschnittsgehalt über die gleiche AbteilungID.*
`SELECT Name, Gehalt  
`FROM Mitarbeiter m # m ist ein Alias für die Tabelle 
`WHERE Gehalt > (  
 `` SELECT AVG(Gehalt)  
  `FROM Mitarbeiter  
  `WHERE AbteilungID = m.AbteilungID);

Und hier noch ein komplexeres Beispiel mit verschachtelten SELECTs als Vorschau auf die nächste Sitzung. Eine Liste aller Mitarbeiter, die in einer Abteilung in einer Stadt arbeiten, in der mindestens ein Mitarbeiter mehr als 80.000 verdient:

`SELECT Name  
`FROM mitarbeiter  
`WHERE AbteilungID IN (  
  ` SELECT AbteilungID  
    `FROM Abteilung  
    `WHERE Ort IN (  
     ` SELECT a.Ort   
     ` FROM Abteilung a  
        `JOIN Mitarbeiter m ON a.AbteilungID = m.AbteilungID  
        `WHERE m.Gehalt > 80000));


# Arbeit an meinem DB Projekt
#python #dbmodel #git
## Doku
- Frühere Überlegungen zusammen gesucht und auf GitHub geschoben
- Strickanleitungen als ProbeData auf GitHub geschoben
- Viel MergeKonflikte erzeugt und gelöst
- Ich arbeite auf meinem eigenen Repo
## Nächste Schritte
### Texte einlesen
#### Idee:
Mein Programm und die Datenbank ändern, sodass ich Strickanleitungen pdf als Text in direkt in der DB speichern.
Erstmal mit bestehendem Programm und DB versuchen. 
##### Wie sieht das Ergebnis aus?
Im Prinzip funktioniert das einlesen. Die langen und unformartierten Filenamen führen zu Konflikten.
#### Wie sieht mein Usecase aus?
Ist in dem Fall Medium gleich Anleitung? 
- Ein pdf ist der download einer Anleitung.
	- Sie liegt als Datei irgendwo
	- ohne Infos oder Metadaten
- Wenn ich die Texte einlese kann ich sie durchsuchen.
In welcher Tabelle macht es sinn Texte zu speichern?
- Möglichkeiten
	- in Anleitung -> jede Anleitung hat eine große Textspalte, nur ein Bruchteil braucht sie
	- als eigenen Tabelle mit Verkünpfung zu Anleitung - > weniger Speicher als Spalte, alle anderen Medien auch WEbsites sind über die Mediendatenbank verknüpft.
	- Als eigene Medientabelle
	- [ ] wie sieht die Tabelle aus
	- Von WEbsite oder Flyer abgeleitet. Das macht keinen Sinn. Viele PDf sind als PDF konzieperit und werden so verkauft
- Nicht alle pdf Anleitungen eignen sich zum Umwandeln in Text.
	- Manche Schnittmuster sind PDFs
		- Diese müssen ausgedruckt werden
		- Aufruf der Datei aus der DB heraus
		- [ ] ERweiterung der Tabelle Schnittmuster
- Manchmal ist es sinnvoller pdf oder jpg zu speichern.
	- Strickschriften
	- scanns oder fotos jpg enthalte aber manchmal auch nur text. 
- Wie lese ich das ganze wieder aus?
	- wie ist die quallität der Texte in der DB?
	- Hat py die Struktur erkannt?
Was ist mit andern Formaten z.B. html?
